# Домашнее задание к занятию «Микросервисы: принципы» - `Иншаков Владимир`

Вы работаете в крупной компании, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps-специалисту необходимо выдвинуть предложение по организации инфраструктуры для разработки и эксплуатации.

## Задача 1: API Gateway 

Предложите решение для обеспечения реализации API Gateway. Составьте сравнительную таблицу возможностей различных программных решений. На основе таблицы сделайте выбор решения.

Решение должно соответствовать следующим требованиям:
- маршрутизация запросов к нужному сервису на основе конфигурации,
- возможность проверки аутентификационной информации в запросах,
- обеспечение терминации HTTPS.

Обоснуйте свой выбор.

## Задача 2: Брокер сообщений

Составьте таблицу возможностей различных брокеров сообщений. На основе таблицы сделайте обоснованный выбор решения.

Решение должно соответствовать следующим требованиям:
- поддержка кластеризации для обеспечения надёжности,
- хранение сообщений на диске в процессе доставки,
- высокая скорость работы,
- поддержка различных форматов сообщений,
- разделение прав доступа к различным потокам сообщений,
- простота эксплуатации.

Обоснуйте свой выбор.

---

## Решение 1: API Gateway

Вначале приведу сравнительную таблицу API Gateways:

![Table_1](https://github.com/MrVanG0gh/microservices_01/blob/main/1.png)

В качестве кандидатов были рассмотрены несколько программных продуктов: Kong, NGINX (Plus), Amazon API Gateway, Azure API Management (Gateway), Apigee, Tyk Gateway и KrakenD. В ходе изучения возможностей каждого из продуктов удалось выяснить, что каждый из них в том или ином виде поддерживает маршрутизацию запросов на основе конфигураций, обладают возможностью проверки аутентификационной информации в запросах и обеспечивают терминацию HTTPS.

Поскольку в исходных данных не уточнялось, где располагается инфраструктура, предположим, что компания не пользуется облачными сервисами Amazon AWS и Microsoft Azure, и можно исключить из рассмотрения API Gateway от соответствующих фирм.

Если компания использует инфраструктуру в стороннем облаке, то идеальным выбором будет `Apigee`, если же инфраструктура развернута на собственном «железе» (on-premise) или гибридная, то лучше подойдут `Kong`, `Nginx`.

## Решение 2: Брокер сообщений

Вначале соберем все полученные сведения по продуктам в сравнительную таблицу:

![Table_2](https://github.com/MrVanG0gh/microservices_01/blob/main/2.png)

Постараемся проанализировать полученные данные.

- Поддержку кластеризации обеспечивают все кандидаты. 
- В вопросе хранения сообщений на диске особняком стоит решение `Redis`, все остальные справляются без проблем.
- Самая высокая скорость работы (высокая пропускная способность при низкой задержке) отмечается у решений от Apache (`Kafka` и `Pulsar`).
- Поддерживаемые форматы сообщений у всех решений примерно одинаковые (с учетом того, что зачастую формат сообщения может иметь произвольный вид).
- Разделение прав доступа к различным потокам сообщений реализовано в том или ином виде во всех продуктах.
- Проще всего в эксплуатации `Redis Streams` и `NATS`. Самыми сложными являются `Apache Kafka` и `Apache Pulsar`

Итог:

Если можно компенсировать сложность в эксплуатации высокой скоростью работы, то я бы порекомендовал компании внедрить `Apache Kafka` (возможно, что большой накопленный опыт сообществом будет нивелировать сложность), либо `Apache Pulsar`.

---